<!DOCTYPE html>
<html>
<head>
    <title>{{.Service.Name}} - cmonit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta http-equiv="refresh" content="60">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <!-- Breadcrumb Navigation -->
        <nav class="text-sm text-gray-500 mb-4">
            <a href="/" class="hover:text-gray-700 hover:underline">Status Overview</a>
            <span class="mx-2">/</span>
            <a href="/host/{{.HostID}}" class="hover:text-gray-700 hover:underline">{{.Hostname}}</a>
            <span class="mx-2">/</span>
            <span class="text-gray-900">{{.Service.Name}}</span>
        </nav>

        <h1 class="text-4xl font-bold text-gray-800 mb-4">Service Details: {{.Service.Name}}</h1>
        <p class="text-gray-600 mb-8">Last updated: {{.LastUpdate.Format "2006-01-02 15:04:05"}}</p>

        <!-- Service Information Card -->
        <div class="bg-white rounded-lg shadow-md mb-6">
            <div class="{{if eq .Service.Status 0}}bg-green-600{{else if eq .Service.Status 2}}bg-yellow-600{{else if eq .Service.Status 1}}bg-red-600{{else}}bg-gray-600{{end}} text-white px-6 py-4 rounded-t-lg">
                <h2 class="text-2xl font-semibold">{{.Service.Name}}</h2>
                <p class="text-sm opacity-90">{{.Service.TypeName}} Service on {{.Hostname}}</p>
            </div>

            <div class="p-6">
                <!-- Basic Service Info -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div>
                        <div class="text-xs text-gray-500 uppercase mb-1">Status</div>
                        <span class="px-3 py-1 rounded text-sm {{if eq .Service.Status 0}}bg-green-500{{else if eq .Service.Status 2}}bg-yellow-500{{else if eq .Service.Status 1}}bg-red-500{{else}}bg-gray-500{{end}} text-white inline-block">
                            {{.Service.StatusMessage}}
                        </span>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 uppercase mb-1">Type</div>
                        <div class="font-semibold">{{.Service.TypeName}}</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 uppercase mb-1">Monitoring</div>
                        <div class="font-semibold">{{if eq .Service.Monitor 1}}Enabled{{else}}Disabled{{end}}</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 uppercase mb-1">Last Checked</div>
                        <div class="font-semibold">{{.Service.CollectedAt.Format "15:04:05"}}</div>
                    </div>
                </div>

                {{if .FilesystemData}}
                <!-- Filesystem Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">Filesystem Metrics</h3>

                    <!-- Filesystem Info -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Filesystem Type</div>
                            <div class="font-semibold">{{.FilesystemData.FSType}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Permissions</div>
                            <div class="font-semibold">{{.FilesystemData.Mode}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Owner</div>
                            <div class="font-semibold">{{.FilesystemData.UID}}:{{.FilesystemData.GID}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Mount Flags</div>
                            <div class="text-sm">{{.FilesystemData.FSFlags}}</div>
                        </div>
                    </div>

                    <!-- Disk Usage -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Disk Space Usage</h4>
                        <div class="bg-gray-200 rounded-full h-6 overflow-hidden mb-2">
                            <div class="{{if lt .FilesystemData.BlockPercent 80.0}}bg-green-500{{else if lt .FilesystemData.BlockPercent 90.0}}bg-yellow-500{{else}}bg-red-500{{end}} h-full flex items-center justify-center text-white text-sm font-semibold" style="width: {{.FilesystemData.BlockPercent}}%">
                                {{printf "%.1f" .FilesystemData.BlockPercent}}%
                            </div>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-sm">
                            <div>
                                <span class="text-gray-500">Used:</span>
                                <span class="font-semibold">{{printf "%.1f" (divf .FilesystemData.BlockUsageMB 1024)}} GB</span>
                            </div>
                            <div>
                                <span class="text-gray-500">Free:</span>
                                <span class="font-semibold">{{printf "%.1f" (divf (sub .FilesystemData.BlockTotalMB .FilesystemData.BlockUsageMB) 1024)}} GB</span>
                            </div>
                            <div>
                                <span class="text-gray-500">Total:</span>
                                <span class="font-semibold">{{printf "%.1f" (divf .FilesystemData.BlockTotalMB 1024)}} GB</span>
                            </div>
                        </div>
                    </div>

                    <!-- Inode Usage -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Inode Usage</h4>
                        <div class="bg-gray-200 rounded-full h-6 overflow-hidden mb-2">
                            <div class="bg-blue-500 h-full flex items-center justify-center text-white text-sm font-semibold" style="width: {{.FilesystemData.InodePercent}}%">
                                {{printf "%.1f" .FilesystemData.InodePercent}}%
                            </div>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-sm">
                            <div>
                                <span class="text-gray-500">Used:</span>
                                <span class="font-semibold">{{.FilesystemData.InodeUsage}}</span>
                            </div>
                            <div>
                                <span class="text-gray-500">Free:</span>
                                <span class="font-semibold">{{sub .FilesystemData.InodeTotal .FilesystemData.InodeUsage}}</span>
                            </div>
                            <div>
                                <span class="text-gray-500">Total:</span>
                                <span class="font-semibold">{{.FilesystemData.InodeTotal}}</span>
                            </div>
                        </div>
                    </div>

                    <!-- I/O Statistics -->
                    <div>
                        <h4 class="font-semibold mb-2">I/O Statistics</h4>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-gray-50 p-3 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">Total Read</div>
                                <div class="font-semibold">{{printf "%.1f" (divf .FilesystemData.ReadBytesTotal 1073741824)}} GB</div>
                                <div class="text-xs text-gray-500">{{.FilesystemData.ReadOpsTotal}} ops</div>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">Total Written</div>
                                <div class="font-semibold">{{printf "%.1f" (divf .FilesystemData.WriteBytesTotal 1073741824)}} GB</div>
                                <div class="text-xs text-gray-500">{{.FilesystemData.WriteOpsTotal}} ops</div>
                            </div>
                        </div>
                    </div>
                </div>
                {{end}}

                {{if .ProcessData}}
                <!-- Process Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">Process Metrics</h3>

                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Process ID</div>
                            <div class="font-semibold">{{.ProcessData.PID}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">CPU Usage</div>
                            <div class="font-semibold">{{printf "%.1f" .ProcessData.CPUPercent}}%</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Memory Usage</div>
                            <div class="font-semibold">{{printf "%.1f" .ProcessData.MemoryPercent}}%</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Memory Size</div>
                            <div class="font-semibold">{{printf "%.1f" (divf .ProcessData.MemoryKB 1024)}} MB</div>
                        </div>
                    </div>
                </div>
                {{end}}

                {{if .FileData}}
                <!-- File Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">File Metrics</h3>

                    <!-- File Information --><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Permissions</div>
                            <div class="font-semibold font-mono">{{.FileData.Mode}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Owner</div>
                            <div class="font-semibold">{{.FileData.UID}}:{{.FileData.GID}}</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">File Size</div>
                            <div class="font-semibold">
                                {{if ge .FileData.Size 1073741824}}
                                    {{printf "%.2f" (divf .FileData.Size 1073741824)}} GB
                                {{else if ge .FileData.Size 1048576}}
                                    {{printf "%.2f" (divf .FileData.Size 1048576)}} MB
                                {{else if ge .FileData.Size 1024}}
                                    {{printf "%.2f" (divf .FileData.Size 1024)}} KB
                                {{else}}
                                    {{.FileData.Size}} bytes
                                {{end}}
                            </div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Hard Links</div>
                            <div class="font-semibold">{{.FileData.Hardlink}}</div>
                        </div>
                    </div>

                    <!-- Timestamps -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">Timestamps</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gray-50 p-3 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">Last Access</div>
                                <div class="font-semibold">{{if .FileData.AccessTime}}{{.FileData.AccessTime}}{{else}}N/A{{end}}</div>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">Last Modified</div>
                                <div class="font-semibold">{{if .FileData.ModifyTime}}{{.FileData.ModifyTime}}{{else}}N/A{{end}}</div>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">Last Change</div>
                                <div class="font-semibold">{{if .FileData.ChangeTime}}{{.FileData.ChangeTime}}{{else}}N/A{{end}}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Checksum -->
                    <div>
                        <h4 class="font-semibold mb-3">Checksum</h4>
                        <div class="bg-gray-50 p-4 rounded">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <div class="text-xs text-gray-500 uppercase mb-1">Algorithm</div>
                                    <div class="font-semibold">{{if .FileData.ChecksumType}}{{.FileData.ChecksumType}}{{else}}N/A{{end}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-500 uppercase mb-1">Value</div>
                                    <div class="font-mono text-sm break-all">{{if .FileData.ChecksumValue}}{{.FileData.ChecksumValue}}{{else}}N/A{{end}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {{end}}

                {{if .NetworkData}}
                <!-- Network Interface Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">Network Interface Metrics</h3>

                    <!-- Link Status -->
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Link Status</div>
                            <span class="px-3 py-1 rounded text-sm {{if eq .NetworkData.LinkState 1}}bg-green-500{{else}}bg-red-500{{end}} text-white inline-block">
                                {{if eq .NetworkData.LinkState 1}}Up{{else}}Down{{end}}
                            </span>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Link Speed</div>
                            <div class="font-semibold">
                                {{if ge .NetworkData.LinkSpeed 1000000000}}
                                    {{printf "%.1f" (divf .NetworkData.LinkSpeed 1000000000)}} Gbps
                                {{else}}
                                    {{printf "%.1f" (divf .NetworkData.LinkSpeed 1000000)}} Mbps
                                {{end}}
                            </div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 uppercase mb-1">Duplex Mode</div>
                            <div class="font-semibold">{{if eq .NetworkData.LinkDuplex 1}}Full-Duplex{{else}}Half-Duplex{{end}}</div>
                        </div>
                    </div>

                    <!-- Download Statistics -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-blue-700">Download Statistics</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <div class="bg-blue-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Packets/sec (Now)</div>
                                <div class="font-semibold text-lg">{{.NetworkData.DownloadPacketsNow}}</div>
                                <div class="text-xs text-gray-500">Total: {{.NetworkData.DownloadPacketsTotal}}</div>
                            </div>
                            <div class="bg-blue-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Bytes/sec (Now)</div>
                                <div class="font-semibold text-lg">
                                    {{if ge .NetworkData.DownloadBytesNow 1048576}}
                                        {{printf "%.2f" (divf .NetworkData.DownloadBytesNow 1048576)}} MB/s
                                    {{else if ge .NetworkData.DownloadBytesNow 1024}}
                                        {{printf "%.2f" (divf .NetworkData.DownloadBytesNow 1024)}} KB/s
                                    {{else}}
                                        {{.NetworkData.DownloadBytesNow}} B/s
                                    {{end}}
                                </div>
                                <div class="text-xs text-gray-500">Total: {{printf "%.2f" (divf .NetworkData.DownloadBytesTotal 1073741824)}} GB</div>
                            </div>
                            <div class="bg-blue-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Errors (Now)</div>
                                <div class="font-semibold text-lg {{if gt .NetworkData.DownloadErrorsNow 0}}text-red-600{{end}}">{{.NetworkData.DownloadErrorsNow}}</div>
                                <div class="text-xs text-gray-500">Total: {{.NetworkData.DownloadErrorsTotal}}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Upload Statistics -->
                    <div>
                        <h4 class="font-semibold mb-3 text-green-700">Upload Statistics</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <div class="bg-green-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Packets/sec (Now)</div>
                                <div class="font-semibold text-lg">{{.NetworkData.UploadPacketsNow}}</div>
                                <div class="text-xs text-gray-500">Total: {{.NetworkData.UploadPacketsTotal}}</div>
                            </div>
                            <div class="bg-green-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Bytes/sec (Now)</div>
                                <div class="font-semibold text-lg">
                                    {{if ge .NetworkData.UploadBytesNow 1048576}}
                                        {{printf "%.2f" (divf .NetworkData.UploadBytesNow 1048576)}} MB/s
                                    {{else if ge .NetworkData.UploadBytesNow 1024}}
                                        {{printf "%.2f" (divf .NetworkData.UploadBytesNow 1024)}} KB/s
                                    {{else}}
                                        {{.NetworkData.UploadBytesNow}} B/s
                                    {{end}}
                                </div>
                                <div class="text-xs text-gray-500">Total: {{printf "%.2f" (divf .NetworkData.UploadBytesTotal 1073741824)}} GB</div>
                            </div>
                            <div class="bg-green-50 p-3 rounded">
                                <div class="text-xs text-gray-600 uppercase mb-1">Errors (Now)</div>
                                <div class="font-semibold text-lg {{if gt .NetworkData.UploadErrorsNow 0}}text-red-600{{end}}">{{.NetworkData.UploadErrorsNow}}</div>
                                <div class="text-xs text-gray-500">Total: {{.NetworkData.UploadErrorsTotal}}</div>
                            </div>
                        </div>
                    </div>
                </div>
                {{end}}

                {{if .ProgramData}}
                <!-- Program Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">Program Metrics</h3>

                    <!-- Program Status -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-50 p-4 rounded">
                            <div class="text-xs text-gray-500 uppercase mb-1">Exit Status</div>
                            <div class="text-2xl font-bold {{if eq .ProgramData.ExitStatus 0}}text-green-600{{else}}text-red-600{{end}}">
                                {{.ProgramData.ExitStatus}}
                            </div>
                            <div class="text-xs mt-1">
                                {{if eq .ProgramData.ExitStatus 0}}
                                    <span class="text-green-600">Success</span>
                                {{else}}
                                    <span class="text-red-600">Failed</span>
                                {{end}}
                            </div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <div class="text-xs text-gray-500 uppercase mb-1">Last Started</div>
                            <div class="font-semibold">
                                {{if .ProgramData.Started}}{{.ProgramData.Started}}{{else}}N/A{{end}}
                            </div>
                        </div>
                    </div>

                    <!-- Program Output -->
                    <div>
                        <h4 class="font-semibold mb-3">Last Output</h4>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded font-mono text-sm overflow-x-auto">
                            {{if .ProgramData.Output}}
                                <pre class="whitespace-pre-wrap">{{.ProgramData.Output}}</pre>
                            {{else}}
                                <span class="text-gray-500">No output available</span>
                            {{end}}
                        </div>
                    </div>
                </div>
                {{end}}

                {{if .RemoteHostData}}
                <!-- Remote Host Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">Remote Host Metrics</h3>

                    {{if .RemoteHostData.ICMPType}}
                    <!-- ICMP / Ping Monitoring -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-blue-700">ICMP Ping Monitor</h4>
                        <div class="bg-blue-50 p-4 rounded">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Ping Type</div>
                                    <div class="font-semibold">{{.RemoteHostData.ICMPType}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Response Time</div>
                                    <div class="text-2xl font-bold {{if lt .RemoteHostData.ICMPResponseTimeMs 100}}text-green-600{{else if lt .RemoteHostData.ICMPResponseTimeMs 500}}text-yellow-600{{else}}text-red-600{{end}}">
                                        {{printf "%.2f" .RemoteHostData.ICMPResponseTimeMs}} ms
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {{end}}

                    {{if .RemoteHostData.PortHostname}}
                    <!-- Port Monitoring -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-green-700">Port Monitor</h4>
                        <div class="bg-green-50 p-4 rounded">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Target Host</div>
                                    <div class="font-semibold font-mono">{{.RemoteHostData.PortHostname}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Port</div>
                                    <div class="font-semibold">{{.RemoteHostData.PortNumber}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Protocol</div>
                                    <div class="font-semibold">{{.RemoteHostData.PortProtocol}} / {{.RemoteHostData.PortType}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Response Time</div>
                                    <div class="text-2xl font-bold {{if lt .RemoteHostData.PortResponseTimeMs 100}}text-green-600{{else if lt .RemoteHostData.PortResponseTimeMs 500}}text-yellow-600{{else}}text-red-600{{end}}">
                                        {{printf "%.2f" .RemoteHostData.PortResponseTimeMs}} ms
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {{end}}

                    {{if .RemoteHostData.UnixPath}}
                    <!-- Unix Socket Monitoring -->
                    <div>
                        <h4 class="font-semibold mb-3 text-purple-700">Unix Socket Monitor</h4>
                        <div class="bg-purple-50 p-4 rounded">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Socket Path</div>
                                    <div class="font-semibold font-mono text-sm break-all">{{.RemoteHostData.UnixPath}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Protocol</div>
                                    <div class="font-semibold">{{.RemoteHostData.UnixProtocol}}</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-600 uppercase mb-1">Response Time</div>
                                    <div class="text-2xl font-bold {{if lt .RemoteHostData.UnixResponseTimeMs 50}}text-green-600{{else if lt .RemoteHostData.UnixResponseTimeMs 200}}text-yellow-600{{else}}text-red-600{{end}}">
                                        {{printf "%.2f" .RemoteHostData.UnixResponseTimeMs}} ms
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {{end}}
                </div>
                {{end}}

                {{if .SystemData}}
                <!-- System Metrics -->
                <div class="border-t pt-6">
                    <h3 class="text-xl font-semibold mb-4">System Metrics</h3>

                    <!-- Load Average -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">Load Average</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gray-50 p-4 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">1 Minute</div>
                                <div class="text-2xl font-bold text-gray-900">
                                    {{if .SystemData.Load1Min}}{{printf "%.2f" .SystemData.Load1Min}}{{else}}N/A{{end}}
                                </div>
                            </div>
                            <div class="bg-gray-50 p-4 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">5 Minutes</div>
                                <div class="text-2xl font-bold text-gray-900">
                                    {{if .SystemData.Load5Min}}{{printf "%.2f" .SystemData.Load5Min}}{{else}}N/A{{end}}
                                </div>
                            </div>
                            <div class="bg-gray-50 p-4 rounded">
                                <div class="text-xs text-gray-500 uppercase mb-1">15 Minutes</div>
                                <div class="text-2xl font-bold text-gray-900">
                                    {{if .SystemData.Load15Min}}{{printf "%.2f" .SystemData.Load15Min}}{{else}}N/A{{end}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CPU Usage Breakdown -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">CPU Usage Breakdown</h4>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">User</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUUser}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-blue-500 h-full" style="width: {{.SystemData.CPUUser}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">System</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUSystem}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-red-500 h-full" style="width: {{.SystemData.CPUSystem}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Nice</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUNice}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-green-500 h-full" style="width: {{.SystemData.CPUNice}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">I/O Wait</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUWait}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-yellow-500 h-full" style="width: {{.SystemData.CPUWait}}%"></div>
                                </div>
                            </div>

                            {{if or (ne .SystemData.CPUHardIRQ 0.0) (ne .SystemData.CPUSoftIRQ 0.0) (ne .SystemData.CPUSteal 0.0) (ne .SystemData.CPUGuest 0.0) (ne .SystemData.CPUGuestNice 0.0)}}
                            <!-- Extended Linux CPU Metrics (only shown if any extended metric is non-zero) -->
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Hard IRQ</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUHardIRQ}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-purple-500 h-full" style="width: {{.SystemData.CPUHardIRQ}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Soft IRQ</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUSoftIRQ}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-pink-500 h-full" style="width: {{.SystemData.CPUSoftIRQ}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Steal</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUSteal}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-orange-500 h-full" style="width: {{.SystemData.CPUSteal}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Guest</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUGuest}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-indigo-500 h-full" style="width: {{.SystemData.CPUGuest}}%"></div>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">Guest Nice</span>
                                    <span class="font-semibold">{{printf "%.1f%%" .SystemData.CPUGuestNice}}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                    <div class="bg-teal-500 h-full" style="width: {{.SystemData.CPUGuestNice}}%"></div>
                                </div>
                            </div>
                            {{end}}
                        </div>
                    </div>

                    <!-- Memory Usage -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">Memory Usage</h4>
                        <div class="bg-gray-200 rounded-full h-6 overflow-hidden mb-2">
                            {{if .SystemData.MemoryPercent}}
                            <div class="{{if lt .SystemData.MemoryPercent 80.0}}bg-green-500{{else if lt .SystemData.MemoryPercent 90.0}}bg-yellow-500{{else}}bg-red-500{{end}} h-full flex items-center justify-center text-white text-sm font-semibold" style="width: {{.SystemData.MemoryPercent}}%">
                                {{printf "%.1f%%" .SystemData.MemoryPercent}}
                            </div>
                            {{else}}
                            <div class="bg-gray-400 h-full flex items-center justify-center text-white text-sm font-semibold" style="width: 0%">
                                N/A
                            </div>
                            {{end}}
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-3 rounded">
                                <span class="text-gray-500 block mb-1">Used</span>
                                <span class="font-semibold text-lg">
                                    {{if .SystemData.MemoryKB}}
                                        {{if ge .SystemData.MemoryKB 1073741824}}
                                            {{printf "%.2f GB" (divf .SystemData.MemoryKB 1073741824)}}
                                        {{else if ge .SystemData.MemoryKB 1048576}}
                                            {{printf "%.2f MB" (divf .SystemData.MemoryKB 1048576)}}
                                        {{else}}
                                            {{printf "%.2f KB" .SystemData.MemoryKB}}
                                        {{end}}
                                    {{else}}
                                        N/A
                                    {{end}}
                                </span>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <span class="text-gray-500 block mb-1">Percentage</span>
                                <span class="font-semibold text-lg">
                                    {{if .SystemData.MemoryPercent}}{{printf "%.1f%%" .SystemData.MemoryPercent}}{{else}}N/A{{end}}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Swap Usage -->
                    <div>
                        <h4 class="font-semibold mb-3">Swap Usage</h4>
                        <div class="bg-gray-200 rounded-full h-6 overflow-hidden mb-2">
                            {{if .SystemData.SwapPercent}}
                            <div class="{{if lt .SystemData.SwapPercent 50.0}}bg-green-500{{else if lt .SystemData.SwapPercent 80.0}}bg-yellow-500{{else}}bg-red-500{{end}} h-full flex items-center justify-center text-white text-sm font-semibold" style="width: {{.SystemData.SwapPercent}}%">
                                {{printf "%.1f%%" .SystemData.SwapPercent}}
                            </div>
                            {{else}}
                            <div class="bg-gray-400 h-full flex items-center justify-center text-white text-sm font-semibold" style="width: 0%">
                                N/A
                            </div>
                            {{end}}
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-3 rounded">
                                <span class="text-gray-500 block mb-1">Used</span>
                                <span class="font-semibold text-lg">
                                    {{if .SystemData.SwapKB}}
                                        {{if ge .SystemData.SwapKB 1073741824}}
                                            {{printf "%.2f GB" (divf .SystemData.SwapKB 1073741824)}}
                                        {{else if ge .SystemData.SwapKB 1048576}}
                                            {{printf "%.2f MB" (divf .SystemData.SwapKB 1048576)}}
                                        {{else}}
                                            {{printf "%.2f KB" .SystemData.SwapKB}}
                                        {{end}}
                                    {{else}}
                                        N/A
                                    {{end}}
                                </span>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <span class="text-gray-500 block mb-1">Percentage</span>
                                <span class="font-semibold text-lg">
                                    {{if .SystemData.SwapPercent}}{{printf "%.1f%%" .SystemData.SwapPercent}}{{else}}N/A{{end}}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                {{end}}

                <!-- Back Link -->
                <div class="border-t pt-6 mt-6">
                    <a href="/host/{{.HostID}}" class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors">
                        Back to {{.Hostname}} Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
